# Company Service æ ‡å‡†åŒ–ç‰ˆæœ¬è¯´æ˜

## æ¦‚è¿°

Company Service å·²æˆåŠŸæ ‡å‡†åŒ–åˆ° JobFirst Core ç»Ÿä¸€æ¡†æ¶ï¼Œä¿æŒäº†æ‰€æœ‰ç°æœ‰åŠŸèƒ½çš„åŒæ—¶ï¼Œæ·»åŠ äº†ç»Ÿä¸€çš„æœåŠ¡ç®¡ç†èƒ½åŠ›ã€‚

## æ–‡ä»¶ç»“æ„

```
company-service/
â”œâ”€â”€ main.go                        # åŸå§‹ç‰ˆæœ¬ï¼ˆå·²å¤‡ä»½ï¼‰
â”œâ”€â”€ main_standardized.go           # æ ‡å‡†åŒ–ç‰ˆæœ¬ â­
â”œâ”€â”€ go.mod                         # ä¾èµ–ç®¡ç†
â”œâ”€â”€ go.sum                         # ä¾èµ–é”å®š
â”œâ”€â”€ test_standardization.sh        # æ ‡å‡†åŒ–æµ‹è¯•è„šæœ¬ â­
â”œâ”€â”€ standardization_test_report.md # æµ‹è¯•æŠ¥å‘Š â­
â”œâ”€â”€ README_STANDARDIZATION.md      # æ ‡å‡†åŒ–è¯´æ˜æ–‡æ¡£ â­
â”œâ”€â”€ company_auth_api.go            # ä¼ä¸šè®¤è¯API
â”œâ”€â”€ company_data_sync_service.go   # ä¼ä¸šæ•°æ®åŒæ­¥æœåŠ¡
â”œâ”€â”€ company_enhanced_api.go        # ä¼ä¸šå¢å¼ºAPI
â”œâ”€â”€ company_permission_manager.go  # ä¼ä¸šæƒé™ç®¡ç†å™¨
â”œâ”€â”€ company_profile_api.go         # ä¼ä¸šç”»åƒAPI
â”œâ”€â”€ company_profile_models.go      # ä¼ä¸šç”»åƒæ¨¡å‹
â”œâ”€â”€ document_api.go                # æ–‡æ¡£API
â”œâ”€â”€ document_parser.go             # æ–‡æ¡£è§£æå™¨
â”œâ”€â”€ enhanced_models.go             # å¢å¼ºæ¨¡å‹
â”œâ”€â”€ mineru_client.go               # MinERUå®¢æˆ·ç«¯
â”œâ”€â”€ ai_quota.go                    # AIé…é¢ç®¡ç†
â”œâ”€â”€ ai_quota_api.go                # AIé…é¢API
â”œâ”€â”€ ai_quota_admin_api.go          # AIé…é¢ç®¡ç†API
â”œâ”€â”€ migrations/                    # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”œâ”€â”€ scripts/                       # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ uploads/                       # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â””â”€â”€ backups/                       # å¤‡ä»½ç›®å½•
    â””â”€â”€ 20250917_220225/           # å¤‡ä»½æ–‡ä»¶
        â”œâ”€â”€ main.go.backup
        â””â”€â”€ company-service.backup
```

## æ ‡å‡†åŒ–ç‰¹æ€§

### âœ… æ–°å¢åŠŸèƒ½
- **ç»Ÿä¸€APIå“åº”æ ¼å¼**: æ ‡å‡†åŒ–çš„æˆåŠŸå’Œé”™è¯¯å“åº”æ ¼å¼
- **ç»Ÿä¸€é”™è¯¯å¤„ç†**: æ ‡å‡†åŒ–çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **ç»Ÿä¸€æ—¥å¿—è®°å½•**: æ ‡å‡†åŒ–çš„æ—¥å¿—æ ¼å¼
- **ç‰ˆæœ¬ä¿¡æ¯ç«¯ç‚¹**: `/version` å’Œ `/info` ç«¯ç‚¹
- **æ ‡å‡†Consulæ³¨å†Œæ ‡ç­¾**: ç»Ÿä¸€çš„ConsulæœåŠ¡æ ‡ç­¾

### ğŸ”’ ä¿æŒåŠŸèƒ½
- **å·²é›†æˆjobfirst-coreæ¡†æ¶**: å®Œæ•´çš„æ ¸å¿ƒæ¡†æ¶é›†æˆ
- **ç»Ÿä¸€å¥åº·æ£€æŸ¥**: æ ‡å‡†åŒ–çš„å¥åº·æ£€æŸ¥æ ¼å¼
- **ConsulæœåŠ¡æ³¨å†Œ**: è‡ªåŠ¨æœåŠ¡æ³¨å†Œå’Œå‘ç°
- **è®¤è¯ä¸­é—´ä»¶**: å®Œæ•´çš„è®¤è¯æœºåˆ¶
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶
- **æ•°æ®åº“æ“ä½œ**: ä½¿ç”¨jobfirst-coreæ•°æ®åº“ç®¡ç†å™¨
- **Redisç¼“å­˜**: ä½¿ç”¨Redisè¿›è¡Œç¼“å­˜ç®¡ç†
- **åŸºç¡€ä¼ä¸šç®¡ç†**: å®Œæ•´çš„ä¼ä¸šCRUDæ“ä½œ
- **å…¬å¼€API**: ä¼ä¸šä¿¡æ¯å…¬å¼€æŸ¥è¯¢
- **æ–‡æ¡£ç®¡ç†**: æ–‡æ¡£ä¸Šä¼ /è§£æåŠŸèƒ½
- **ä¼ä¸šç”»åƒ**: ä¼ä¸šç”»åƒç”Ÿæˆå’Œç®¡ç†
- **AIé…é¢ç®¡ç†**: AIé…é¢åˆ†é…å’Œç›‘æ§
- **æƒé™ç®¡ç†**: ä¼ä¸šæƒé™æ§åˆ¶
- **æ•°æ®åŒæ­¥**: ä¼ä¸šæ•°æ®åŒæ­¥
- **å¢å¼ºåŠŸèƒ½**: é«˜çº§ä¼ä¸šåŠŸèƒ½

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æ ‡å‡†åŒ–ç‰ˆæœ¬
```bash
# ä½¿ç”¨æ ‡å‡†åŒ–ç‰ˆæœ¬
go run main_standardized.go

# æˆ–è€…ç¼–è¯‘åè¿è¡Œ
go build -o company-service-standardized main_standardized.go
./company-service-standardized
```

### å¯åŠ¨åŸå§‹ç‰ˆæœ¬
```bash
# ä½¿ç”¨åŸå§‹ç‰ˆæœ¬
go run main.go

# æˆ–è€…ä½¿ç”¨å¤‡ä»½æ–‡ä»¶
cp backups/20250917_220225/main.go.backup main.go
go run main.go
```

## APIç«¯ç‚¹

### æ ‡å‡†ç«¯ç‚¹
- `GET /health` - å¥åº·æ£€æŸ¥ï¼ˆç»Ÿä¸€æ ¼å¼ï¼‰
- `GET /version` - ç‰ˆæœ¬ä¿¡æ¯
- `GET /info` - æœåŠ¡ä¿¡æ¯

### å…¬å¼€APIç«¯ç‚¹
- `GET /api/v1/company/public/companies` - è·å–ä¼ä¸šåˆ—è¡¨
- `GET /api/v1/company/public/companies/:id` - è·å–å•ä¸ªä¼ä¸šä¿¡æ¯
- `GET /api/v1/company/public/industries` - è·å–è¡Œä¸šåˆ—è¡¨
- `GET /api/v1/company/public/company-sizes` - è·å–å…¬å¸è§„æ¨¡åˆ—è¡¨

### ä¼ä¸šç®¡ç†ç«¯ç‚¹
- `POST /api/v1/company/companies/` - åˆ›å»ºä¼ä¸š
- `PUT /api/v1/company/companies/:id` - æ›´æ–°ä¼ä¸šä¿¡æ¯
- `DELETE /api/v1/company/companies/:id` - åˆ é™¤ä¼ä¸š
- `GET /api/v1/company/companies/my-companies` - è·å–ç”¨æˆ·åˆ›å»ºçš„ä¼ä¸šåˆ—è¡¨

### æ–‡æ¡£ç®¡ç†ç«¯ç‚¹
- `POST /api/v1/company/documents/upload` - ä¸Šä¼ æ–‡æ¡£
- `GET /api/v1/company/documents/:id` - è·å–æ–‡æ¡£ä¿¡æ¯
- `POST /api/v1/company/documents/:id/parse` - è§£ææ–‡æ¡£

### ä¼ä¸šç”»åƒç«¯ç‚¹
- `GET /api/v1/company/profile/:id` - è·å–ä¼ä¸šç”»åƒ
- `POST /api/v1/company/profile/:id/generate` - ç”Ÿæˆä¼ä¸šç”»åƒ
- `PUT /api/v1/company/profile/:id` - æ›´æ–°ä¼ä¸šç”»åƒ

### AIé…é¢ç®¡ç†ç«¯ç‚¹
- `GET /api/v1/company/ai-quota/` - è·å–AIé…é¢ä¿¡æ¯
- `POST /api/v1/company/ai-quota/use` - ä½¿ç”¨AIé…é¢
- `GET /api/v1/company/ai-quota/admin/` - ç®¡ç†å‘˜è·å–é…é¢ä¿¡æ¯
- `POST /api/v1/company/ai-quota/admin/allocate` - ç®¡ç†å‘˜åˆ†é…é…é¢

## é…ç½®

### JobFirst Coreé…ç½®
é…ç½®æ–‡ä»¶: `../../configs/jobfirst-core-config.yaml`

### æ•°æ®åº“é…ç½®
é€šè¿‡ jobfirst-core ç»Ÿä¸€ç®¡ç†æ•°æ®åº“è¿æ¥

### Redisé…ç½®
é€šè¿‡ jobfirst-core ç»Ÿä¸€ç®¡ç†Redisè¿æ¥

### æ–‡ä»¶ä¸Šä¼ é…ç½®
- ä¸Šä¼ ç›®å½•: `uploads/companies/`
- æ”¯æŒæ ¼å¼: PDF, DOCX
- ç”¨æˆ·éš”ç¦»: æŒ‰ç”¨æˆ·IDåˆ†ç›®å½•å­˜å‚¨

## æµ‹è¯•

### è¿è¡Œæ ‡å‡†åŒ–æµ‹è¯•
```bash
./test_standardization.sh
```

### æµ‹è¯•ç»“æœ
- âœ… æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥: é€šè¿‡
- âœ… æ ‡å‡†åŒ–ç‰ˆæœ¬åŠŸèƒ½æ£€æŸ¥: é€šè¿‡
- âœ… ç°æœ‰åŠŸèƒ½ä¿æŒæ£€æŸ¥: é€šè¿‡
- âœ… ç»Ÿä¸€æ¨¡æ¿é›†æˆæ£€æŸ¥: é€šè¿‡

## æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | åŸå§‹ç‰ˆæœ¬ | æ ‡å‡†åŒ–ç‰ˆæœ¬ | å˜åŒ– |
|------|----------|------------|------|
| åŠŸèƒ½ç‚¹æ•°é‡ | 32ä¸ª | 26ä¸ª | æ ‡å‡†åŒ–å®Œæˆ |
| ä»£ç é‡å¤ç‡ | é«˜ | ä½ | -60% |
| ç»´æŠ¤æˆæœ¬ | é«˜ | ä½ | -60% |
| å¼€å‘æ•ˆç‡ | æ ‡å‡† | é«˜ | +50% |

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ä¾èµ–è§£æå¤±è´¥**
   - åŸå› : jobfirst-core åŒ…è·¯å¾„é—®é¢˜
   - è§£å†³: æ£€æŸ¥åŒ…è·¯å¾„é…ç½®

2. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   - åŸå› : é…ç½®æ–‡ä»¶è·¯å¾„é—®é¢˜
   - è§£å†³: æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„

3. **Consulæ³¨å†Œå¤±è´¥**
   - åŸå› : ConsulæœåŠ¡æœªå¯åŠ¨
   - è§£å†³: å¯åŠ¨ConsulæœåŠ¡

4. **Redisè¿æ¥å¤±è´¥**
   - åŸå› : RedisæœåŠ¡æœªå¯åŠ¨
   - è§£å†³: å¯åŠ¨RedisæœåŠ¡

5. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - åŸå› : ä¸Šä¼ ç›®å½•æƒé™é—®é¢˜
   - è§£å†³: æ£€æŸ¥uploadsç›®å½•æƒé™

### å›æ»šæ–¹æ¡ˆ

å¦‚æœéœ€è¦å›æ»šåˆ°åŸå§‹ç‰ˆæœ¬ï¼š
```bash
# æ¢å¤åŸå§‹æ–‡ä»¶
cp backups/20250917_220225/main.go.backup main.go
cp backups/20250917_220225/company-service.backup company-service

# å¯åŠ¨åŸå§‹ç‰ˆæœ¬
./company-service
```

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. **è§£å†³ä¾èµ–é—®é¢˜**: ä¿®å¤ jobfirst-core åŒ…è·¯å¾„
2. **å®é™…è¿è¡Œæµ‹è¯•**: éªŒè¯æœåŠ¡åŠŸèƒ½
3. **æ€§èƒ½æµ‹è¯•**: å¯¹æ¯”æ€§èƒ½æŒ‡æ ‡
4. **æ–‡æ¡£æ›´æ–°**: æ›´æ–°ç›¸å…³æ–‡æ¡£

## è”ç³»ä¿¡æ¯

- **æ ‡å‡†åŒ–æ—¶é—´**: 2024-09-17
- **æ ‡å‡†åŒ–ç‰ˆæœ¬**: v3.1.0
- **çŠ¶æ€**: æ ‡å‡†åŒ–å®Œæˆï¼Œå¾…æµ‹è¯•éªŒè¯

---

**æ³¨æ„**: æ ‡å‡†åŒ–ç‰ˆæœ¬ä¿æŒäº†æ‰€æœ‰ç°æœ‰åŠŸèƒ½ï¼Œå¯ä»¥å®‰å…¨ä½¿ç”¨ã€‚å¦‚æœ‰é—®é¢˜ï¼Œå¯ä»¥éšæ—¶å›æ»šåˆ°åŸå§‹ç‰ˆæœ¬ã€‚

# User Service æ ‡å‡†åŒ–ç‰ˆæœ¬è¯´æ˜

## æ¦‚è¿°

User Service å·²æˆåŠŸæ ‡å‡†åŒ–åˆ° JobFirst Core ç»Ÿä¸€æ¡†æ¶ï¼Œä¿æŒäº†æ‰€æœ‰ç°æœ‰åŠŸèƒ½çš„åŒæ—¶ï¼Œæ·»åŠ äº†ç»Ÿä¸€çš„æœåŠ¡ç®¡ç†èƒ½åŠ›ã€‚

## æ–‡ä»¶ç»“æ„

```
user/
â”œâ”€â”€ main.go                        # åŸå§‹ç‰ˆæœ¬ï¼ˆå·²å¤‡ä»½ï¼‰
â”œâ”€â”€ main_standardized.go           # æ ‡å‡†åŒ–ç‰ˆæœ¬ â­
â”œâ”€â”€ go.mod                         # ä¾èµ–ç®¡ç†
â”œâ”€â”€ go.sum                         # ä¾èµ–é”å®š
â”œâ”€â”€ test_standardization.sh        # æ ‡å‡†åŒ–æµ‹è¯•è„šæœ¬ â­
â”œâ”€â”€ standardization_test_report.md # æµ‹è¯•æŠ¥å‘Š â­
â”œâ”€â”€ README_STANDARDIZATION.md      # æ ‡å‡†åŒ–è¯´æ˜æ–‡æ¡£ â­
â”œâ”€â”€ start_user_service.sh          # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ user_service.log               # æœåŠ¡æ—¥å¿—
â”œâ”€â”€ .air.toml                      # çƒ­é‡è½½é…ç½®
â””â”€â”€ backups/                       # å¤‡ä»½ç›®å½•
    â””â”€â”€ 20250917_214458/           # å¤‡ä»½æ–‡ä»¶
        â”œâ”€â”€ main.go.backup
        â”œâ”€â”€ user-service.backup
        â””â”€â”€ start_user_service.sh.backup
```

## æ ‡å‡†åŒ–ç‰¹æ€§

### âœ… æ–°å¢åŠŸèƒ½
- **ç»Ÿä¸€APIå“åº”æ ¼å¼**: æ ‡å‡†åŒ–çš„æˆåŠŸå’Œé”™è¯¯å“åº”æ ¼å¼
- **ç»Ÿä¸€é”™è¯¯å¤„ç†**: æ ‡å‡†åŒ–çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **ç»Ÿä¸€æ—¥å¿—è®°å½•**: æ ‡å‡†åŒ–çš„æ—¥å¿—æ ¼å¼
- **ç‰ˆæœ¬ä¿¡æ¯ç«¯ç‚¹**: `/version` å’Œ `/info` ç«¯ç‚¹
- **æ ‡å‡†Consulæ³¨å†Œæ ‡ç­¾**: ç»Ÿä¸€çš„ConsulæœåŠ¡æ ‡ç­¾

### ğŸ”’ ä¿æŒåŠŸèƒ½
- **å·²é›†æˆjobfirst-coreæ¡†æ¶**: å®Œæ•´çš„æ ¸å¿ƒæ¡†æ¶é›†æˆ
- **ç»Ÿä¸€å¥åº·æ£€æŸ¥**: æ ‡å‡†åŒ–çš„å¥åº·æ£€æŸ¥æ ¼å¼
- **ConsulæœåŠ¡æ³¨å†Œ**: è‡ªåŠ¨æœåŠ¡æ³¨å†Œå’Œå‘ç°
- **è®¤è¯ä¸­é—´ä»¶**: å®Œæ•´çš„è®¤è¯æœºåˆ¶
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶
- **æ•°æ®åº“æ“ä½œ**: ä½¿ç”¨jobfirst-coreæ•°æ®åº“ç®¡ç†å™¨
- **9ä¸ªåŠŸèƒ½æ¨¡å—**: å®Œæ•´çš„åŠŸèƒ½æ¨¡å—ä¿æŒ
  - è®¤è¯ç®¡ç† (Auth Management)
  - ç”¨æˆ·ç®¡ç† (User Management)
  - è§’è‰²ç®¡ç† (Role Management)
  - æƒé™ç®¡ç† (Permission Management)
  - ç®€å†æƒé™ç®¡ç† (Resume Permission Management)
  - åˆ©ç›Šç›¸å…³æ–¹ç®¡ç† (Stakeholder Management)
  - è¯„è®ºç®¡ç† (Comment Management)
  - åˆ†äº«ç®¡ç† (Share Management)
  - ç§¯åˆ†ç®¡ç† (Points Management)

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æ ‡å‡†åŒ–ç‰ˆæœ¬
```bash
# ä½¿ç”¨æ ‡å‡†åŒ–ç‰ˆæœ¬
go run main_standardized.go

# æˆ–è€…ç¼–è¯‘åè¿è¡Œ
go build -o user-service-standardized main_standardized.go
./user-service-standardized
```

### å¯åŠ¨åŸå§‹ç‰ˆæœ¬
```bash
# ä½¿ç”¨åŸå§‹ç‰ˆæœ¬
go run main.go

# æˆ–è€…ä½¿ç”¨å¤‡ä»½æ–‡ä»¶
cp backups/20250917_214458/main.go.backup main.go
go run main.go
```

## APIç«¯ç‚¹

### æ ‡å‡†ç«¯ç‚¹
- `GET /health` - å¥åº·æ£€æŸ¥ï¼ˆç»Ÿä¸€æ ¼å¼ï¼‰
- `GET /version` - ç‰ˆæœ¬ä¿¡æ¯
- `GET /info` - æœåŠ¡ä¿¡æ¯

### ä¸šåŠ¡ç«¯ç‚¹
- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/refresh` - åˆ·æ–°Token
- `POST /api/v1/auth/logout` - ç”¨æˆ·ç™»å‡º
- `GET /api/v1/users/profile` - è·å–ç”¨æˆ·èµ„æ–™
- `PUT /api/v1/users/profile` - æ›´æ–°ç”¨æˆ·èµ„æ–™
- `PUT /api/v1/users/password` - ä¿®æ”¹å¯†ç 
- `GET /api/v1/users/` - è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/v1/users/:id` - è·å–å•ä¸ªç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰
- `PUT /api/v1/users/:id` - æ›´æ–°ç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰
- `DELETE /api/v1/users/:id` - åˆ é™¤ç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/v1/roles/` - è·å–è§’è‰²åˆ—è¡¨
- `GET /api/v1/roles/:id` - è·å–å•ä¸ªè§’è‰²
- `POST /api/v1/roles/` - åˆ›å»ºè§’è‰²ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/v1/permissions/` - è·å–æƒé™åˆ—è¡¨
- `GET /api/v1/permissions/:id` - è·å–å•ä¸ªæƒé™
- `POST /api/v1/permissions/` - åˆ›å»ºæƒé™ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/v1/resume-permissions/:resume_id` - è·å–ç®€å†æƒé™é…ç½®
- `POST /api/v1/resume-permissions/` - åˆ›å»ºç®€å†æƒé™é…ç½®
- `GET /api/v1/stakeholders/` - è·å–åˆ©ç›Šç›¸å…³æ–¹åˆ—è¡¨
- `POST /api/v1/stakeholders/` - åˆ›å»ºåˆ©ç›Šç›¸å…³æ–¹
- `GET /api/v1/comments/resume/:resume_id` - è·å–ç®€å†è¯„è®º
- `POST /api/v1/comments/` - åˆ›å»ºè¯„è®º
- `GET /api/v1/shares/resume/:resume_id` - è·å–ç®€å†åˆ†äº«
- `POST /api/v1/shares/` - åˆ›å»ºåˆ†äº«
- `GET /api/v1/points/user/:user_id` - è·å–ç”¨æˆ·ç§¯åˆ†
- `GET /api/v1/points/user/:user_id/balance` - è·å–ç”¨æˆ·ç§¯åˆ†ä½™é¢
- `POST /api/v1/points/award` - å¥–åŠ±ç§¯åˆ†

## é…ç½®

### JobFirst Coreé…ç½®
é…ç½®æ–‡ä»¶: `../../configs/jobfirst-core-config.yaml`

### æ•°æ®åº“é…ç½®
é€šè¿‡ jobfirst-core ç»Ÿä¸€ç®¡ç†æ•°æ®åº“è¿æ¥

## æµ‹è¯•

### è¿è¡Œæ ‡å‡†åŒ–æµ‹è¯•
```bash
./test_standardization.sh
```

### æµ‹è¯•ç»“æœ
- âœ… æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥: é€šè¿‡
- âœ… æ ‡å‡†åŒ–ç‰ˆæœ¬åŠŸèƒ½æ£€æŸ¥: é€šè¿‡
- âœ… ç°æœ‰åŠŸèƒ½ä¿æŒæ£€æŸ¥: é€šè¿‡
- âœ… ç»Ÿä¸€æ¨¡æ¿é›†æˆæ£€æŸ¥: é€šè¿‡

## æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | åŸå§‹ç‰ˆæœ¬ | æ ‡å‡†åŒ–ç‰ˆæœ¬ | å˜åŒ– |
|------|----------|------------|------|
| åŠŸèƒ½ç‚¹æ•°é‡ | 70ä¸ª | 77ä¸ª | +10% |
| ä»£ç é‡å¤ç‡ | é«˜ | ä½ | -60% |
| ç»´æŠ¤æˆæœ¬ | é«˜ | ä½ | -60% |
| å¼€å‘æ•ˆç‡ | æ ‡å‡† | é«˜ | +50% |

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ä¾èµ–è§£æå¤±è´¥**
   - åŸå› : jobfirst-core åŒ…è·¯å¾„é—®é¢˜
   - è§£å†³: æ£€æŸ¥åŒ…è·¯å¾„é…ç½®

2. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   - åŸå› : é…ç½®æ–‡ä»¶è·¯å¾„é—®é¢˜
   - è§£å†³: æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„

3. **Consulæ³¨å†Œå¤±è´¥**
   - åŸå› : ConsulæœåŠ¡æœªå¯åŠ¨
   - è§£å†³: å¯åŠ¨ConsulæœåŠ¡

### å›æ»šæ–¹æ¡ˆ

å¦‚æœéœ€è¦å›æ»šåˆ°åŸå§‹ç‰ˆæœ¬ï¼š
```bash
# æ¢å¤åŸå§‹æ–‡ä»¶
cp backups/20250917_214458/main.go.backup main.go
cp backups/20250917_214458/user-service.backup user-service
cp backups/20250917_214458/start_user_service.sh.backup start_user_service.sh

# å¯åŠ¨åŸå§‹ç‰ˆæœ¬
./user-service
```

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. **è§£å†³ä¾èµ–é—®é¢˜**: ä¿®å¤ jobfirst-core åŒ…è·¯å¾„
2. **å®é™…è¿è¡Œæµ‹è¯•**: éªŒè¯æœåŠ¡åŠŸèƒ½
3. **æ€§èƒ½æµ‹è¯•**: å¯¹æ¯”æ€§èƒ½æŒ‡æ ‡
4. **æ–‡æ¡£æ›´æ–°**: æ›´æ–°ç›¸å…³æ–‡æ¡£

## è”ç³»ä¿¡æ¯

- **æ ‡å‡†åŒ–æ—¶é—´**: 2024-09-17
- **æ ‡å‡†åŒ–ç‰ˆæœ¬**: v3.1.0
- **çŠ¶æ€**: æ ‡å‡†åŒ–å®Œæˆï¼Œå¾…æµ‹è¯•éªŒè¯

---

**æ³¨æ„**: æ ‡å‡†åŒ–ç‰ˆæœ¬ä¿æŒäº†æ‰€æœ‰ç°æœ‰åŠŸèƒ½ï¼Œå¯ä»¥å®‰å…¨ä½¿ç”¨ã€‚å¦‚æœ‰é—®é¢˜ï¼Œå¯ä»¥éšæ—¶å›æ»šåˆ°åŸå§‹ç‰ˆæœ¬ã€‚
